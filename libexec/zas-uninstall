#!/usr/bin/env bash
#
# Summary: Remove zas system hooks
#
# Usage: zas uninstall

set -e

FIREWALL_PLIST_PATH="/Library/LaunchDaemons/com.zas.firewall.plist"

# Uninstall the DNS resolver

echo "Uninstalling DNS resolver"
grep -Rl 'Generated by Zas' /etc/resolver/ | sudo xargs rm

# Uninstall port forwarding

echo "Uninstalling port forward"
sudo launchctl unload "$FIREWALL_PLIST_PATH" 2>/dev/null || true
sudo rm -f "$FIREWALL_PLIST_PATH"
